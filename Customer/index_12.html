<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=0">
    <title>购物车</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="lib/css/weui.min.css">
    <link rel="stylesheet" type="text/css" href="lib/css/jquery-weui.min.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <script src="lib/js/jquery-2.1.4.js"></script>
    <script src="lib/js/jquery-weui.min.js"></script>
    <script src="lib/js/swiper.min.js"></script>
</head>

<body>
    <div class="containe containe_carts">
        <div class="headerBox">
            <p>购物车</p>
        </div>
        <div class="shopOperate">
            <div class="shop_item">
                <p class="name">一加人深圳直营店</p>
                <p class="note"><span class="sign">活动</span>活动产品，预购从速<img src="img/arrow_R.png"></p>
                <div class="weui-media-box weui-media-box_appmsg m_weui-media-box">
                    <div class="weui-media-box__hd">
                        <div class="weui-flex">
                            <div class="weui-flex__item">
                                <div class="weui-cells weui-cells_checkbox m_weui-cells_checkbox">
                                    <label class="weui-cell weui-check__label" for="id_01">
                                        <div class="weui-cell__hd">
                                            <input type="checkbox" class="weui-check" name="ids" id="id_01" checked="checked">
                                            <i class="weui-icon-checked"></i>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <div class="weui-flex__item">
                                <img class="weui-media-box__thumb" src="img/product_list.jpg">
                            </div>
                        </div>
                    </div>
                    <div class="weui-media-box__bd">
                        <div class="content">
                            <p class="msg">创维E366W+核智能酷开智能电视</p>
                            <p class="weight">重量：14.5kg</p>
                            <div class="operate">
                                <p class="price">￥<span>300.00</span></p>
                                <div class="container">
                                    <span class="subtract" onclick="updata_numbers(this,1,300)">-</span>
                                    <span class="count">1</span>
                                    <span class="add" onclick="updata_numbers(this,2,300)">+</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="shop_item">
                <p class="name">一加人深圳直营店</p>
                <p class="note"><span class="sign">活动</span>活动产品，预购从速<img src="img/arrow_R.png"></p>
                <div class="weui-media-box weui-media-box_appmsg m_weui-media-box">
                    <div class="weui-media-box__hd">
                        <div class="weui-flex">
                            <div class="weui-flex__item">
                                <div class="weui-cells weui-cells_checkbox m_weui-cells_checkbox">
                                    <label class="weui-cell weui-check__label" for="id_02">
                                        <div class="weui-cell__hd">
                                            <input type="checkbox" class="weui-check" name="ids" id="id_02" checked="checked">
                                            <i class="weui-icon-checked"></i>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <div class="weui-flex__item">
                                <img class="weui-media-box__thumb" src="img/product_list.jpg">
                            </div>
                        </div>
                    </div>
                    <div class="weui-media-box__bd">
                        <div class="content">
                            <p class="msg">创维E366W+核智能酷开智能电视</p>
                            <p class="weight">重量：14.5kg</p>
                            <div class="operate">
                                <p class="price">￥<span>4300.50</span></p>
                                <div class="container">
                                    <span class="subtract" onclick="updata_numbers(this,1,4300.50)">-</span>
                                    <span class="count">1</span>
                                    <span class="add" onclick="updata_numbers(this,2,4300.50)">+</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="settlementBox">
            <div class="settlement">
                <p>去结算（<span id="all_product_total">0</span>）</p>
            </div>
            <div class="total">
                <div class="weui-cells weui-cells_checkbox m_weui-cells_checkbox">
                    <label class="weui-cell weui-check__label" for="ids_all">
                        <div class="weui-cell__hd">
                            <input type="checkbox" class="weui-check" id="ids_all" name="ids_all" checked="checked">
                            <i class="weui-icon-checked"></i>
                        </div>
                        <div class="weui-cell__bd">
                            <p>全选</p>
                        </div>
                    </label>
                </div>
                <p>合计:￥<span id="all_cost_total">0.00</span></p>
            </div>
        </div>
    </div>
    <div class="weui-tabbar m_weui-tabbar">
        <a href="#tab1" class="weui-tabbar__item">
            <div class="weui-tabbar__icon">
                <img src="img/icon_home.png" alt="">
            </div>
            <p class="weui-tabbar__label">首页</p>
        </a>
        <a href="#tab2" class="weui-tabbar__item">
            <div class="weui-tabbar__icon">
                <img src="img/icon_category.png" alt="">
            </div>
            <p class="weui-tabbar__label">分类</p>
        </a>
        <a href="#tab3" class="weui-tabbar__item weui-bar__item--on">
            <div class="weui-tabbar__icon">
                <img src="img/icon_category.png" alt="">
            </div>
            <p class="weui-tabbar__label">购物车</p>
        </a>
        <a href="#tab4" class="weui-tabbar__item">
            <div class="weui-tabbar__icon">
                <img src="img/icon_category.png" alt="">
            </div>
            <p class="weui-tabbar__label">我的</p>
        </a>
    </div>
    <script type="text/javascript">
        $(function(){
            check_selected();
        })

        $('input:checkbox[name=ids_all]').on('click', function(){
            if($(this).is(':checked')){
                $('input:checkbox[name=ids]').prop('checked', true);
            }else{
                $('input:checkbox[name=ids]').prop('checked', false);
            }
            check_selected();
        });

        $('input:checkbox[name=ids]').on('click', function(){
            check_selected();
        });

        function check_selected(){
            var checks = $('input:checkbox[name=ids]')
            var n = 0;
            var all_cost = 0;
            for(i=0; i<checks.length; i++){
                if(checks[i].checked){
                    n++;
                    var _this_cost = Number($(checks[i]).parents(".shop_item").find(".price span").text());
                    all_cost += _this_cost;
                }
            }
            if(checks.length==n){
                $('input:checkbox[name=ids_all]').prop('checked', true);
            }else{
                $('input:checkbox[name=ids_all]').prop('checked', false);
            }
            $("#all_product_total").text(n);
            $("#all_cost_total").text(all_cost);
        }

        function updata_numbers(obj,types,price){
            var number,number_obj;
            if(types=='1') {
                number_obj=$(obj).next();
                number = parseInt(number_obj.text());
                if(number>1){
                    number--;
                }else{
                  return false;
                }
            }else{
                number_obj = $(obj).prev();
                number = parseInt(number_obj.text());
                number++;
            }
            number_obj.text(number);
            var product_sum=price*number;
            $(obj).parents('.operate').find('.price span').text(product_sum.toFixed(2));
            check_selected();
        }
    </script>
</body>
